-- -- DROP AFTER DELETE TRIGGER
-- DROP TRIGGER IF EXISTS `tr_mot_test_ad`;
-- 
-- CREATE TRIGGER `tr_mot_test_ad`
-- AFTER DELETE ON `mot_test`
-- FOR EACH ROW INSERT INTO `mot_test_hist` (`hist_transaction_type`,
--                                           `hist_batch_number`,
--                                           `id`,
--                                           `person_id`,
--                                           `vehicle_id`,
--                                           `vehicle_version`,
--                                           `document_id`,
--                                           `site_id`,
--                                           `primary_colour_id`,
--                                           `secondary_colour_id`,
--                                           `vehicle_class_id`,
--                                           `tested_as_fuel_type_id`,
--                                           `vin`,
--                                           `empty_vin_reason_id`,
--                                           `registration`,
--                                           `empty_vrm_reason_id`,
--                                           `make_id`,
--                                           `model_id`,
--                                           `model_detail_id`,
--                                           `country_of_registration_id`,
--                                           `has_registration`,
--                                           `mot_test_type_id`,
--                                           `started_date`,
--                                           `completed_date`,
--                                           `status_id`,
--                                           `issued_date`,
--                                           `expiry_date`,
--                                           `mot_test_id_original`,
--                                           `prs_mot_test_id`,
--                                           `mot_test_reason_for_cancel_id`,
--                                           `reason_for_cancel_comment_id`,
--                                           `reason_for_termination_comment`,
--                                           `full_partial_retest_id`,
--                                           `partial_reinspection_comment_id`,
--                                           `items_not_tested_comment_id`,
--                                           `one_person_test`,
--                                           `one_person_reinspection`,
--                                           `complaint_ref`,
--                                           `number`,
--                                           `odometer_reading_id`,
--                                           `private`,
--                                           `emergency_log_id`,
--                                           `emergency_reason_lookup_id`,
--                                           `emergency_reason_comment_id`,
--                                           `vehicle_weight_source_lookup_id`,
--                                           `vehicle_weight`,
--                                           `incognito_vehicle_id`,
--                                           `address_comment_id`,
--                                           `mot1_legacy_id`,
--                                           `created_by`,
--                                           `created_on`,
--                                           `last_updated_by`,
--                                           `last_updated_on`,
--                                           `version`,
--                                           `batch_number`,
--                                           `make_name`,
--                                           `model_name`,
--                                           `model_detail_name`,
--                                           `client_ip`)
-- VALUES ('D',
--         COALESCE(@BATCH_NUMBER, 0),
--         OLD.`id`,
--         OLD.`person_id`,
--         OLD.`vehicle_id`,
--         OLD.`vehicle_version`,
--         OLD.`document_id`,
--         OLD.`site_id`,
--         OLD.`primary_colour_id`,
--         OLD.`secondary_colour_id`,
--         OLD.`vehicle_class_id`,
--         OLD.`tested_as_fuel_type_id`,
--         OLD.`vin`,
--         OLD.`empty_vin_reason_id`,
--         OLD.`registration`,
--         OLD.`empty_vrm_reason_id`,
--         OLD.`make_id`,
--         OLD.`model_id`,
--         OLD.`model_detail_id`,
--         OLD.`country_of_registration_id`,
--         OLD.`has_registration`,
--         OLD.`mot_test_type_id`,
--         OLD.`started_date`,
--         OLD.`completed_date`,
--         OLD.`status_id`,
--         OLD.`issued_date`,
--         OLD.`expiry_date`,
--         OLD.`mot_test_id_original`,
--         OLD.`prs_mot_test_id`,
--         OLD.`mot_test_reason_for_cancel_id`,
--         OLD.`reason_for_cancel_comment_id`,
--         OLD.`reason_for_termination_comment`,
--         OLD.`full_partial_retest_id`,
--         OLD.`partial_reinspection_comment_id`,
--         OLD.`items_not_tested_comment_id`,
--         OLD.`one_person_test`,
--         OLD.`one_person_reinspection`,
--         OLD.`complaint_ref`,
--         OLD.`number`,
--         OLD.`odometer_reading_id`,
--         OLD.`private`,
--         OLD.`emergency_log_id`,
--         OLD.`emergency_reason_lookup_id`,
--         OLD.`emergency_reason_comment_id`,
--         OLD.`vehicle_weight_source_lookup_id`,
--         OLD.`vehicle_weight`,
--         OLD.`incognito_vehicle_id`,
--         OLD.`address_comment_id`,
--         OLD.`mot1_legacy_id`,
--         OLD.`created_by`,
--         OLD.`created_on`,
--         OLD.`last_updated_by`,
--         OLD.`last_updated_on`,
--         OLD.`version`,
--         OLD.`batch_number`,
--         OLD.`make_name`,
--         OLD.`model_name`,
--         OLD.`model_detail_name`,
--         OLD.`client_ip`);
-- 
-- -- DROP AFTER UPDATE TRIGGER
-- DROP TRIGGER IF EXISTS `tr_mot_test_au`;
-- 
-- CREATE TRIGGER `tr_mot_test_au`
-- AFTER UPDATE ON `mot_test`
-- FOR EACH ROW INSERT INTO `mot_test_hist` (`hist_transaction_type`,
--                                           `hist_batch_number`,
--                                           `id`,
--                                           `person_id`,
--                                           `vehicle_id`,
--                                           `vehicle_version`,
--                                           `document_id`,
--                                           `site_id`,
--                                           `primary_colour_id`,
--                                           `secondary_colour_id`,
--                                           `vehicle_class_id`,
--                                           `tested_as_fuel_type_id`,
--                                           `vin`,
--                                           `empty_vin_reason_id`,
--                                           `registration`,
--                                           `empty_vrm_reason_id`,
--                                           `make_id`,
--                                           `model_id`,
--                                           `model_detail_id`,
--                                           `country_of_registration_id`,
--                                           `has_registration`,
--                                           `mot_test_type_id`,
--                                           `started_date`,
--                                           `completed_date`,
--                                           `status_id`,
--                                           `issued_date`,
--                                           `expiry_date`,
--                                           `mot_test_id_original`,
--                                           `prs_mot_test_id`,
--                                           `mot_test_reason_for_cancel_id`,
--                                           `reason_for_cancel_comment_id`,
--                                           `reason_for_termination_comment`,
--                                           `full_partial_retest_id`,
--                                           `partial_reinspection_comment_id`,
--                                           `items_not_tested_comment_id`,
--                                           `one_person_test`,
--                                           `one_person_reinspection`,
--                                           `complaint_ref`,
--                                           `number`,
--                                           `odometer_reading_id`,
--                                           `private`,
--                                           `emergency_log_id`,
--                                           `emergency_reason_lookup_id`,
--                                           `emergency_reason_comment_id`,
--                                           `vehicle_weight_source_lookup_id`,
--                                           `vehicle_weight`,
--                                           `incognito_vehicle_id`,
--                                           `address_comment_id`,
--                                           `mot1_legacy_id`,
--                                           `created_by`,
--                                           `created_on`,
--                                           `last_updated_by`,
--                                           `last_updated_on`,
--                                           `version`,
--                                           `batch_number`,
--                                           `make_name`,
--                                           `model_name`,
--                                           `model_detail_name`,
--                                           `client_ip`)
-- VALUES ('U',
--         COALESCE(@batch_number, CASE WHEN NEW.BATCH_NUMBER <> OLD.BATCH_NUMBER THEN NEW.BATCH_NUMBER
--                                 ELSE 0 END),
--         OLD.`id`,
--         OLD.`person_id`,
--         OLD.`vehicle_id`,
--         OLD.`vehicle_version`,
--         OLD.`document_id`,
--         OLD.`site_id`,
--         OLD.`primary_colour_id`,
--         OLD.`secondary_colour_id`,
--         OLD.`vehicle_class_id`,
--         OLD.`tested_as_fuel_type_id`,
--         OLD.`vin`,
--         OLD.`empty_vin_reason_id`,
--         OLD.`registration`,
--         OLD.`empty_vrm_reason_id`,
--         OLD.`make_id`,
--         OLD.`model_id`,
--         OLD.`model_detail_id`,
--         OLD.`country_of_registration_id`,
--         OLD.`has_registration`,
--         OLD.`mot_test_type_id`,
--         OLD.`started_date`,
--         OLD.`completed_date`,
--         OLD.`status_id`,
--         OLD.`issued_date`,
--         OLD.`expiry_date`,
--         OLD.`mot_test_id_original`,
--         OLD.`prs_mot_test_id`,
--         OLD.`mot_test_reason_for_cancel_id`,
--         OLD.`reason_for_cancel_comment_id`,
--         OLD.`reason_for_termination_comment`,
--         OLD.`full_partial_retest_id`,
--         OLD.`partial_reinspection_comment_id`,
--         OLD.`items_not_tested_comment_id`,
--         OLD.`one_person_test`,
--         OLD.`one_person_reinspection`,
--         OLD.`complaint_ref`,
--         OLD.`number`,
--         OLD.`odometer_reading_id`,
--         OLD.`private`,
--         OLD.`emergency_log_id`,
--         OLD.`emergency_reason_lookup_id`,
--         OLD.`emergency_reason_comment_id`,
--         OLD.`vehicle_weight_source_lookup_id`,
--         OLD.`vehicle_weight`,
--         OLD.`incognito_vehicle_id`,
--         OLD.`address_comment_id`,
--         OLD.`mot1_legacy_id`,
--         OLD.`created_by`,
--         OLD.`created_on`,
--         OLD.`last_updated_by`,
--         OLD.`last_updated_on`,
--         OLD.`version`,
--         OLD.`batch_number`,
--         OLD.`make_name`,
--         OLD.`model_name`,
--         OLD.`model_detail_name`,
--         OLD.`client_ip`);