!contents -R2 -g -p -f -h
'''As a DVSA function I want to request an additional one-time password to be entered by the nominated tester at the point of vehicle test submission, in all circumstances, so that the likelihood of identifying the correct person performing the test is increased.'''

!| GenerateTestDataForOtherFitnesseTests                   |
|siteId? |testerUsername? |testerPassword? |motTestNumber? |
|$siteId=|$testerUsername=|$testerPassword=|$motTestNumber=|


!| GenerateTestDataForOtherFitnesseTests|
|vehicleId?                             |
|$vehicleId1=                           |
|$vehicleId2=                           |
|$vehicleId3=                           |

!|GenerateSystemRoleForOtherFitnesseTests|
|veName?                                 |
|$veUsername=                            |

Finish MOT test with 2FA

!| Vm 2586 Mot Status Otp                                                                                                                                                                                                            |
|vehicleId  |User           |SiteId |Use same test|new Status|One Time Password|Info about Mot test|success?|error messages?                                                                                              |is locked?|
|$vehicleId1|$testerUsername|$siteId|false        |PASSED    |123456           |OTP is valid       |true    |                                                                                                             |false     |
|$vehicleId2|$testerUsername|$siteId|false        |PASSED    |000000           |OTP is invalid     |false   |The PIN you have entered is incorrect                                                                        |false     |
|$vehicleId2|$testerUsername|$siteId|true         |PASSED    |000000           |second attempt     |false   |The PIN you have entered is incorrect                                                                        |false     |
|$vehicleId2|$testerUsername|$siteId|true         |PASSED    |000000           |third attempt      |false   |The PIN you have entered does not match the PIN for this user account, you can reset your PIN in Your profile|true      |
|$vehicleId3|$veUsername    |$siteId|false        |PASSED    |                 |OTP not required   |true    |                                                                                                             |false     |
